<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="./css/common.css">
  <link rel="stylesheet" href="./css/options.css">
  <title>JDA — Settings</title>
</head>
<body>
  <div class="options container ">
    <h1>Job description Analyzer — Settings</h1>
    <div class="grid mt-16">
      <div class="card card_llm">
        <h2>LLM settings</h2>
        <h3>Provider settings</h3>
        <p><button class="btn add-model" title="Add LLM provider" id="addProviderBtn">+ Add provider</button></p>
          <table class="table" id="providersTable">
          <thead><tr><th>Name</th><th>Base URL</th><th>Type</th><th>Key</th><th></th></tr></thead>
          <tbody></tbody>
        </table>

        <h3>Models</h3>
        <p><button class="btn add-model" title="Add model for provider" id="addModelBtn">+ Add model</button></p>
        <table class="table" id="modelsTable">
          <thead><tr><th>Active</th><th>Display name</th><th>Provider</th><th>Model ID</th><th></th></tr></thead>
          <tbody></tbody>
        </table>
        <label>Model-level system prompt (edit per model)</label>
        <div class="muted">Open any model row to edit its system prompt.</div>
      </div>

      <div class="card card_general">
        <h2>General</h2>
        <h3>CV</h3>
        <textarea class="textInput" id="cv"></textarea>

        <h3>System prompt template</h3>
        <textarea class="textInput" id="systemTemplate"></textarea>
        <div class="muted">
          Default included. See templates: <a href="https://github.com/andreykolygin" target="_blank">GitHub</a>.
        </div>

        <h3>Result output template</h3>
        <textarea class="textInput" id="outputTemplate"></textarea>
        
        <!-- Кнопки сохранения и сбороса кэша -->
        <div class="saveBtn">
          <p>
            <button class="btn danger" id="resetCacheBtn" disabled>Reset prompt cache</button>
            <span class="muted ml-8" id="resetHint"></span>
          </p>
          <p><button class="btn primary" id="saveBtn">Save settings</button></p>
        </div>
        
        
        <!-- кнопки экспорта и импорта -->
        <div id="settingsIO" class="io-row">
          <button id="exportSettingsBtn" class="btn">Export settings (JSON)</button>
          <button id="importSettingsBtn" class="btn">Import settings</button>
          <input id="importSettingsFile" type="file" accept="application/json" class="hidden" />
      </div>
      </div>
    </div>
  </div>
<div class="muted">Version <span id="version"></span> • <a id="helpLink" href="#" target="_blank">Help / GitHub</a></div>


  <!-- Add Provider Modal -->
  <dialog id="providerModal">
    <form method="dialog">
      <h3>Add provider</h3>
      <label>Choose a provider or create a custom one</label>
      <select id="providerPreset">
        <option value="custom">Custom</option>
        <option value="anthropic">Anthropic</option>
        <option value="azure">Azure OpenAI</option>
        <option value="deepseek">DeepSeek</option>
        <option value="gemini">Google Gemini</option>
        <option value="huggingface">Hugging Face</option>
        <option value="meta">Meta</option>
        <option value="ollama">Ollama</option>
        <option value="openai">OpenAI</option>
        <option value="openrouter">OpenRouter</option>
        <option value="perplexity">Perplexity</option>
        <option value="xai">XAI</option>
      </select>

      <label>Base URL</label>
      <input id="providerBaseUrl" type="text" placeholder="https://api.example.com"/>

      <label>API key</label>
      <input id="providerApiKey" type="text" placeholder="sk-..."/>
      <div class="muted"><a id="apiKeyLink" href="#" target="_blank">Get your API key here</a></div>

      <menu>
        <button class="btn" value="cancel">Cancel</button>
        <button class="btn primary" id="saveProviderBtn" value="default">Save</button>
      </menu>
    </form>
  </dialog>
  <!-- Add Model Modal -->
  <dialog id="modelModal">
    <form method="dialog">
      <h3>Add model</h3>
      <label>Provider</label>
      <select id="modelProvider"></select>

      <label>Display name</label>
      <input id="modelDisplay" type="text" placeholder="Gemini Flash"/>

      <label>Model ID</label>
      <input id="modelId" type="text" placeholder="gemini-2.0-flash-exp"/>

      <menu>
        <button class="btn" value="cancel">Cancel</button>
        <button class="btn primary" id="saveModelBtn" value="default">Save</button>
      </menu>
    </form>
  </dialog>


  <dialog id="modelPromptModal" class="modal">
  <form method="dialog" class="modal-body">
    <h3>Edit system prompt</h3>
    <p class="hint">This prompt overrides the global System prompt template for this specific model. Leave empty to inherit the global template.</p>
    <textarea id="modelPromptText" rows="12" class="stretch mono"></textarea>
    <div class="modal-actions">
      <button id="cancelModelPromptBtn" type="reset" class="btn">Cancel</button>
      <button id="saveModelPromptBtn" type="button" class="btn primary">Save</button>
    </div>
  </form>
</dialog>

  <script src="options.js"></script>
</body>
</html>
