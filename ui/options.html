<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="./css/common.css">
  <link rel="stylesheet" href="./css/options.css">
  <title>JDA — Settings</title>
</head>
<body class="options-page single-column theme-landing">
  <div class="theme-landing-backdrop" aria-hidden="true">
    <div class="theme-landing-backdrop__grid"></div>
    <div class="theme-landing-backdrop__glow"></div>
  </div>
  <div class="options container options-shell">
    <header class="options-hero">
      <div class="options-meta">
        <span class="options-version">
          <span class="options-version__label">v</span>
          <span class="options-version__value" id="version">–</span>
        </span>
        <a
          class="options-qr"
          href="https://buymeacoffee.com/kolandcom"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="Support the project"
        >
          <img
            src="../icons/qr-code.png"
            alt=""
            width="90"
            height="90"
            loading="lazy"
            decoding="async"
          />
        </a>
      </div>
      <h1 data-i18n="ui.app.title">Job description Analyzer — Settings</h1>
      <p class="options-hero__lead" data-i18n="options.hero.lead"></p>
      <nav class="options-hero__links" aria-label="Landing sections">
        <button type="button" class="link-chip" data-open-url="https://jda.kolygin.com/#features">Features</button>
        <button type="button" class="link-chip" data-open-url="https://jda.kolygin.com/#workflow">Workflow</button>
        <button type="button" class="link-chip" data-open-url="https://jda.kolygin.com/#templates">Templates</button>
      </nav>
    </header>
    <div class="grid mt-16">
      <div class="tabs" id="optionsTabs" role="tablist">
        <button class="tab-button active" data-tab="llm" role="tab" aria-selected="true" data-i18n="options.tabs.llm">LLM Settings</button>
        <button class="tab-button" data-tab="sites" role="tab" aria-selected="false" tabindex="-1" data-i18n="options.tabs.sites">Auto-extraction Rules</button>
        <button class="tab-button" data-tab="prompts" role="tab" aria-selected="false" tabindex="-1" data-i18n="options.tabs.prompts">CV &amp; Prompts</button>
        <button class="tab-button" data-tab="integrations" role="tab" aria-selected="false" tabindex="-1" data-i18n="options.tabs.integrations">Integrations</button>
        <button class="tab-button" data-tab="lang" role="tab" aria-selected="false" tabindex="-1" data-i18n="options.tabs.langIO">Lang &amp; I/O settings</button>
      </div>
      

      <div class="tab-panels">
        <section class="tab-panel active" data-tab="llm" role="tabpanel">
          <div class="card glass card_llm">
            <h2 data-i18n="options.title.llmSettings">LLM settings</h2>
            <h3 data-i18n="options.title.providerSettings">Provider settings</h3>
            <p><button class="btn add-model icon-left i-add" id="addProviderBtn" title="Add LLM provider" data-i18n="options.btn.addProvider" data-i18n-attr-title="options.btn.addProviderTitle">+ Add Provider</button></p>
            <div class="table-wrapper">
              <table class="table" id="providersTable">
              <thead><tr>
                <th data-i18n="options.tbl.name">Name</th>
                <th data-i18n="options.tbl.baseUrl">Base URL</th>
                <th>Type</th>
                <th data-i18n="options.tbl.key">Key</th>
                <th></th>
              </tr></thead>
              <tbody></tbody>
            </table>
            </div>
            <h3 data-i18n="options.title.models">Models</h3>
            <p><button class="btn add-model icon-left i-add" id="addModelBtn" title="Add model for provider" data-i18n="options.btn.addModel" data-i18n-attr-title="options.btn.addModelTitle">+ Add Model</button></p>
            <div class="table-wrapper">
            <table class="table" id="modelsTable">
              <thead><tr>
                <th class="col-drag" title="Drag to reorder">⇅</th>
                <th data-i18n="options.tbl.active">Active</th>
                <th data-i18n="options.tbl.displayName">Display name</th>
                <th data-i18n="options.tbl.provider">Provider</th>
                <th data-i18n="options.tbl.modelId">Model ID</th>
                <th></th></tr></thead>
              <tbody></tbody>
            </table>
            </div>
            <label data-i18n="options.hint.model1">Model-level system prompt (edit per model)</label>
            <div data-i18n="options.hint.model2">Open any model row to edit its system prompt.</div>
          </div>
        </section>

        <section class="tab-panel" data-tab="sites" role="tabpanel" hidden>
          <div class="card glass card_sites">
            <h2 data-i18n="options.title.autoExtract">Auto-extraction Rules</h2>
            <p data-i18n="options.section.description">Add websites and CSS selectors to automatically extract job descriptions.</p>
            <p><button class="btn add-model icon-left i-add" id="addSiteBtn" data-i18n="options.btn.addSiteRule">+ Add Site</button></p>
            <div class="table-wrapper">
              <table class="table" id="sitesTable">
                <thead>
                  <tr>
                    <th data-i18n="options.tbl.active">Active</th>
                    <th data-i18n="options.tbl.site">Site</th>
                    <th data-i18n="options.tbl.extraction" class="word-break">Extraction</th>
                    <th data-i18n="options.tbl.comment">Comment</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </section>

        <section class="tab-panel" data-tab="prompts" role="tabpanel" hidden>
          <div class="card glass card_general">
            <h2 data-i18n="options.title.general">CV &amp; Prompts</h2>
            <h3 data-i18n="options.title.cv">CV</h3>
            <p class="muted" data-i18n="options.cv.managerHint">Store multiple resumes and pick which one to use before analysis.</p>
            <div class="cv-manager" id="cvManager">
              <div class="cv-list-pane">
                <div class="cv-list-header">
                  <div>
                    <p class="label" data-i18n="options.cv.listTitle">Saved resumes</p>
                  </div>
                  <button type="button" class="btn third icon-left i-add" id="cvAddBtn" data-i18n="options.cv.add">Add CV</button>
                </div>
                <div>
                  <p class="muted small" data-i18n="options.cv.listDescription">Select a resume to edit or duplicate it.</p>
                </div>
                <div class="cv-list" id="cvList" role="listbox" aria-label="Saved resumes"></div>
              </div>
              <div class="cv-editor-pane" id="cvEditorPane">
                <div class="cv-editor-header">
                  <label for="cvTitleInput" data-i18n="options.cv.nameLabel">Display name</label>
                  <input type="text" id="cvTitleInput" placeholder="Product Manager CV" data-i18n-attr-placeholder="options.cv.namePlaceholder">
                </div>
                <div class="cv-editor-field">
                  <label for="cvContentInput" data-i18n="options.cv.contentLabel">Resume</label>
                  <textarea class="textInput" id="cvContentInput" rows="12" placeholder="Paste your resume here" data-i18n-attr-placeholder="options.cv.contentPlaceholder"></textarea>
                </div>
                <div class="cv-editor-footer">
                  <div class="cv-editor-actions">
                    <button type="button" class="btn third icon-left i-verified" id="cvSetDefaultBtn" data-i18n="options.cv.setDefault">Use by default</button>
                    <button type="button" class="btn secondary icon-left i-notes" id="cvDuplicateBtn" data-i18n="options.cv.duplicate">Duplicate</button>
                    <button type="button" class="btn danger icon-left i-trash" id="cvDeleteBtn" data-i18n="options.cv.delete">Delete</button>
                  </div>
                  <div class="cv-editor-meta">
                    <span id="cvCharCounter" class="muted small">0</span>
                    <span id="cvDefaultBadge" class="badge" hidden data-i18n="options.cv.defaultBadge">Default</span>
                  </div>
                </div>
              </div>
            </div>

            <h3 data-i18n="options.title.systemPromptTempl">System prompt template</h3>
            <textarea class="textInput" id="systemTemplate"></textarea>

            <h3 data-i18n="options.title.resultOutpTempl">Result output template</h3>
            <textarea class="textInput" id="outputTemplate"></textarea>
            
            <div class="saveBtn">
              <p>
                <button class="btn danger icon-left i-eraser" id="resetCacheBtn" data-i18n="options.btn.resetPromptCache" disabled>Reset prompt cache</button>
                <span class="ml-8" id="resetHint"></span>
              </p>
              <p>
                <button class="btn primary icon-left i-check" id="saveBtn" data-i18n="options.btn.saveSettings">Save settings</button>
              </p>
            </div>
          </div> 
        </section>

        <section class="tab-panel" data-tab="integrations" role="tabpanel" hidden>
          <div class="card glass card_integrations">
            <h2 data-i18n="options.integrations.title">Integrations</h2>
            <div class="form-row switch-row">
              <label for="notionEnabled" class="toggle">
                <span class="toggle__text" data-i18n="options.integrations.notion.enable">Enable “Save to Notion” button</span>
                <span class="toggle__control">
                  <input type="checkbox" id="notionEnabled" class="toggle__input" />
                  <span class="toggle__track" aria-hidden="true">
                    <span class="toggle__thumb"></span>
                  </span>
                </span>
              </label>
            </div>
            <div id="notionSettings" class="notion-settings hidden">
              <p data-i18n="options.integrations.notion.hint">Provide integration secret and database ID from Notion. At least one field must map to a title property.</p>
              <div class="form-row">
                <label for="notionToken" data-i18n="options.integrations.notion.token">Integration token</label>
                <input type="password" id="notionToken" placeholder="secret_..." />
              </div>
              <div class="form-row">
                <label for="notionDatabaseId" data-i18n="options.integrations.notion.database">Database ID</label>
                <input type="text" id="notionDatabaseId" placeholder="xxxxxxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" />
              </div>
              <h3 data-i18n="options.integrations.notion.fields">Field mapping</h3>
              <p><button class="btn add-model icon-left i-add" type="button" id="addNotionFieldBtn" data-i18n="options.integrations.notion.addField">+ Add field</button></p>
              <div id="notionFields" class="notion-field-list"></div>
            </div>
          </div>
        </section>

        <section class="tab-panel" data-tab="lang" role="tabpanel" hidden>
          <div class="twoColumn">
            <div class="flex-items">
              <div class="card glass">
              <h2 data-i18n="options.title.language">Language</h2>
              <div class="settings-grid">
                <div class="settings-col">
                  <div class="form-row">
                    <label for="uiLang" data-i18n="options.lang.label">Interface language</label>
                    <select id="uiLang">
                      <option value="en">English</option>
                      <option value="ru">Русский</option>
                    </select>
                    <p data-i18n="options.lang.hint">Choose UI language (applies to popup &amp; settings)</p>
                  </div>
                </div>
              </div>
              </div>
            </div>
            <div class="flex-items">
              <div class="card glass">
              <h2 data-i18n="options.title.importExport">Import / Export </h2>
              <div class="settings-grid">
                <div class="settings-col">
                  <div id="settingsIO" class="io-row">
                    <button id="exportSettingsBtn" class="btn secondary icon-left i-export" data-i18n="options.btn.exportSettings">Export Settings</button>
                    <button id="importSettingsBtn" class="btn third icon-left i-import" data-i18n="options.btn.importSettings">Import Settings</button>
                    <input id="importSettingsFile" type="file" accept="application/json" class="hidden" />
                  </div>
                  <p class="mt-8">
                    <button class="btn danger icon-left i-default" id="resetDefaultsBtn" data-i18n="options.btn.resetDefaults">Reset to defaults</button>
                  </p>
                </div>
              </div>
              </div>
            </div>
          </div>   
        </section>
      </div>
    </div>
  </div>


  <!-- Add / Edit Provider Modal -->
  <dialog id="providerModal">
    <form method="dialog">
      <h3 data-i18n="options.modal.provider.title">Provider</h3>

      <div class="form-row">
        <label for="providerName" data-i18n="options.modal.provider.name">Name</label>
        <input id="providerName" type="text"
               placeholder="Display name (required)"
               data-i18n-attr-placeholder="options.modal.provider.namePh"
               required />
      </div>

      <div class="form-row">
        <label for="providerPreset" data-i18n="options.modal.provider.preset">Preset</label>
        <select id="providerPreset">
          <option value="custom" data-i18n="options.modal.provider.help.custom">Custom</option>
          <option value="anthropic">Anthropic</option>
          <option value="azure">Azure OpenAI</option>
          <option value="deepseek">DeepSeek</option>
          <option value="gemini">Google Gemini</option>
          <option value="huggingface">Hugging Face</option>
          <option value="meta">Meta</option>
          <option value="ollama">Ollama</option>
          <option value="openai">OpenAI</option>
          <option value="openrouter">OpenRouter</option>
          <option value="perplexity">Perplexity</option>
          <option value="xai">XAI</option>
        </select>
      </div>

      <div class="form-row">
        <label for="providerBaseUrl" data-i18n="options.modal.provider.baseUrl">Base URL</label>
        <input id="providerBaseUrl" type="text"
               placeholder="https://…"
               data-i18n-attr-placeholder="options.modal.provider.baseUrlPh" />
      </div>

      <div class="form-row">
        <label for="providerApiKey" data-i18n="options.modal.provider.apiKey">API key</label>
        <input id="providerApiKey" type="text"
               placeholder="Paste key (optional)"
               data-i18n-attr-placeholder="options.modal.provider.apiKeyPh" />
      </div>

      <div>
        <a id="apiKeyLink" href="#" target="_blank" rel="noopener noreferrer" data-i18n="options.modal.provider.getKey">Get your API key here</a>
        <br/>
        <small id="apiKeyHelp" data-i18n="options.modal.provider.help">Choose preset to see how to get an API key.</small>
      </div>

      <menu>
        <button class="btn icon-left i-undo" value="cancel" data-i18n="options.btn.cancel">Cancel</button>
        <button class="btn primary icon-left i-check" id="saveProviderBtn" value="default" data-i18n="options.btn.save">Save</button>
      </menu>
    </form>
  </dialog>
  <!-- Add / Edit Model Modal -->
  <dialog id="modelModal">
    <form method="dialog">
      <h3 data-i18n="options.modal.model.title">Model</h3>

      <div class="form-row">
        <label for="modelProvider" data-i18n="options.modal.model.provider">Provider</label>
        <select id="modelProvider"></select>
      </div>

      <div class="form-row">
        <label for="modelDisplay" data-i18n="options.modal.model.display">Display name</label>
        <input type="text" id="modelDisplay"
               placeholder="How the model is shown in the UI"
               data-i18n-attr-placeholder="options.modal.model.displayPh" />
      </div>

      <div class="form-row">
        <label for="modelId" data-i18n="options.modal.model.id">Model ID</label>
        <input type="text" id="modelId"
               placeholder="e.g. gpt-4o-mini"
               data-i18n-attr-placeholder="options.modal.model.idPh" />
      </div>

      <menu>
        <button class="btn icon-left i-undo" value="cancel" data-i18n="options.btn.cancel">Cancel</button>
        <button class="btn primary icon-left i-check" id="saveModelBtn" value="default" data-i18n="options.btn.save">Save</button>
      </menu>
    </form>
  </dialog>

  <!-- Modal: add/edit site rule -->
  <dialog id="siteModal" class="wide-modal">
    <form method="dialog">
      <h3 data-i18n="options.modal.site.title">Auto-extract rule</h3>

      <div class="form-row">
        <label for="siteHost" data-i18n="options.modal.site.host">*Site (hostname, wildcard, or /regex/)</label>
        <input type="text" id="siteHost"
               placeholder="e.g. example.com/jobs* or /https:\/\/foo\.bar\/pfx.*/i"
               data-i18n-attr-placeholder="options.modal.site.hostPh" required>
      </div>

      <div class="form-row">
        <label data-i18n="options.modal.site.strategy">Extraction strategy</label>
        <div class="site-strategy-tabs" role="tablist">
          <button type="button" class="site-tab active" data-tab="css" role="tab" aria-selected="true" data-i18n="options.modal.site.strategy.css">CSS selector</button>
          <button type="button" class="site-tab" data-tab="chain" role="tab" aria-selected="false" data-i18n="options.modal.site.strategy.chain">DOM chain</button>
        </div>
        <input type="hidden" id="siteStrategy" value="css">
      </div>

      <div class="form-row site-strategy-panel" data-panel="css" id="siteSelectorRow">
        <label for="siteSelector" data-i18n="options.modal.site.selector">*CSS selector</label>
        <textarea rows="3" id="siteSelector"
                  placeholder=".job-description, [data-role=&quot;jd&quot;]"
                  data-i18n-attr-placeholder="options.modal.site.selectorPh"></textarea>
      </div>

      <div class="form-row site-strategy-panel" data-panel="chain" id="siteChainRow" hidden>
        <div class="chain-row-header">
          <label data-i18n="options.modal.site.chainTitle">Chain groups</label>
          <button type="button" class="btn add-model icon-left i-add" id="addChainGroupBtn" data-i18n="options.modal.site.chainAddGroup">Add Group</button>
        </div>
        <div id="siteChainGroups" class="chain-group-list"></div>
        <p data-i18n="options.modal.site.chainHint">Steps execute in order inside each group. Each selector runs relative to the page, optional “Contains text” narrows matches.</p>
      </div>

      <div class="form-row" id="siteTemplateRow">
        <label for="siteTemplate" data-i18n="options.modal.site.templateLabel">Meta Tags Template</label>
        <textarea rows="6" id="siteTemplate"
                  placeholder="{{title}}\n\n{{meta:name:description}}"></textarea>
        <p data-i18n="options.modal.site.templateHint">Use {{title}}, {{description}}, {{meta:name:description}}, {{schema:@JobPosting:description}}, etc.</p>
        <p data-i18n="options.modal.site.templateWarn">Placeholders are replaced with collected page variables; unknown fields become empty.</p>
        <div class="template-targets">
          <label class="toggle template-toggle">
            <span class="toggle__text" data-i18n="options.modal.site.templateTargetJob">Add to Job description (LLM input)</span>
            <span class="toggle__control">
              <input type="checkbox" id="siteTemplateToJob" class="toggle__input" checked>
              <span class="toggle__track" aria-hidden="true">
                <span class="toggle__thumb"></span>
              </span>
            </span>
          </label>
          <label class="toggle template-toggle">
            <span class="toggle__text" data-i18n="options.modal.site.templateTargetResult">Show in Position matching result</span>
            <span class="toggle__control">
              <input type="checkbox" id="siteTemplateToResult" class="toggle__input" checked>
              <span class="toggle__track" aria-hidden="true">
                <span class="toggle__thumb"></span>
              </span>
            </span>
          </label>
        </div>
      </div>

      <div class="form-row">
        <label for="siteComment" data-i18n="options.modal.site.comment">Comment</label>
        <input type="text" id="siteComment"
               placeholder="Optional note"
               data-i18n-attr-placeholder="options.modal.site.commentPh">
      </div>

      <div class="form-row">
        <label class="toggle toggle--inline">
          <span class="toggle__text" data-i18n="options.tbl.active">Active</span>
          <span class="toggle__control">
            <input type="checkbox" id="siteActive" class="toggle__input" checked>
            <span class="toggle__track" aria-hidden="true">
              <span class="toggle__thumb"></span>
            </span>
          </span>
        </label>
      </div>

      <menu>
        <button class="btn icon-left i-undo" value="cancel" id="cancelSiteBtn" data-i18n="options.btn.cancel">Cancel</button>
        <button type="button" class="btn primary icon-left i-check" id="saveSiteBtn" value="default" data-i18n="options.btn.save">Save</button>
      </menu>
    </form>
  </dialog>

  <dialog id="modelPromptModal" class="modal">
  <form method="dialog" class="modal-body">
    <h3 data-i18n="options.modal.modelPrompt.title">System prompt (per model)</h3>
    <p class="hint" data-i18n="options.modal.modelPrompt.textPh">
      Leave blank to inherit global system template. <code>{{GLOBAL_SYSTEM_PROMPT}}</code> to insert the global prompt, and <code>{{RESULT_OUTPUT_TEMPLATE}}</code> to embed (or remove) the output template.
    </p>
    <textarea id="modelPromptText" rows="12" class="stretch mono"></textarea>
    <div class="modal-actions">
      <button id="cancelModelPromptBtn" type="reset" class="btn icon-left i-undo" data-i18n="options.btn.cancel">Cancel</button>
      <button id="saveModelPromptBtn" type="button" class="btn primary icon-left i-check" data-i18n="options.btn.save">Save</button>
    </div>
  </form>
</dialog>

<!-- Import Settings Modal -->
<dialog id="importModal">
  <form method="dialog">
    <h3 data-i18n="options.import.title">Import settings</h3>

    <fieldset class="mt-8">
      <legend data-i18n="options.import.mode">Import mode</legend>
      <label class="row">
        <input type="radio" name="importMode" value="merge" checked>
        <span data-i18n="options.import.mode.merge">Merge / add (preserve existing)</span>
      </label>
      <label class="row">
        <input type="radio" name="importMode" value="replace">
        <span data-i18n="options.import.mode.replace">Replace data</span>
      </label>
    </fieldset>

    <fieldset class="mt-12 fieldset-column">
      <legend data-i18n="options.import.groups">Groups to import</legend>
      <label class="toggle toggle--inline">
        <span class="toggle__text" data-i18n="options.section.llm">Providers and models</span>
        <span class="toggle__control">
          <input type="checkbox" name="grp" value="providers" class="toggle__input" checked>
          <span class="toggle__track" aria-hidden="true">
            <span class="toggle__thumb"></span>
          </span>
        </span>
      </label>
      <label class="toggle toggle--inline">
        <span class="toggle__text" data-i18n="options.title.models">Models</span>
        <span class="toggle__control">
          <input type="checkbox" name="grp" value="models" class="toggle__input" checked>
          <span class="toggle__track" aria-hidden="true">
            <span class="toggle__thumb"></span>
          </span>
        </span>
      </label>
      <label class="toggle toggle--inline">
        <span class="toggle__text" data-i18n="options.section.rules">Auto-extraction Rules</span>
        <span class="toggle__control">
          <input type="checkbox" name="grp" value="sites" class="toggle__input" checked>
          <span class="toggle__track" aria-hidden="true">
            <span class="toggle__thumb"></span>
          </span>
        </span>
      </label>
      <label class="toggle toggle--inline">
        <span class="toggle__text" data-i18n="options.import.cvs">CVs</span>
        <span class="toggle__control">
          <input type="checkbox" name="grp" value="cvs" class="toggle__input" checked>
          <span class="toggle__track" aria-hidden="true">
            <span class="toggle__thumb"></span>
          </span>
        </span>
      </label>
      <label class="toggle toggle--inline">
        <span class="toggle__text" data-i18n="options.title.systemPromptTempl">System Prompt Template</span>
        <span class="toggle__control">
          <input type="checkbox" name="grp" value="systemTemplate" class="toggle__input" checked>
          <span class="toggle__track" aria-hidden="true">
            <span class="toggle__thumb"></span>
          </span>
        </span>
      </label>
      <label class="toggle toggle--inline">
        <span class="toggle__text" data-i18n="options.title.resultOutpTempl">Result Output Template</span>
        <span class="toggle__control">
          <input type="checkbox" name="grp" value="outputTemplate" class="toggle__input" checked>
          <span class="toggle__track" aria-hidden="true">
            <span class="toggle__thumb"></span>
          </span>
        </span>
      </label>
      <label class="toggle toggle--inline">
        <span class="toggle__text" data-i18n="options.import.integrations">Integrations (Notion)</span>
        <span class="toggle__control">
          <input type="checkbox" name="grp" value="integrations" class="toggle__input" checked>
          <span class="toggle__track" aria-hidden="true">
            <span class="toggle__thumb"></span>
          </span>
        </span>
      </label>
    </fieldset>

    <!-- Drop zone (clickable) -->
    <div id="dropZone" class="drop-zone" tabindex="0" role="button" aria-label="Choose JSON file by click or drop">
      <p data-i18n="options.modal.import.drop">Drag & drop a JSON file here or click to choose…</p>
    </div>
    <!-- hidden file input used by drop zone click -->
    <input id="importFileInput" type="file" accept="application/json" hidden />

    <p data-i18n="options.modal.import.paste">Paste JSON code below</p>
    <textarea id="importText" rows="10" class="stretch mono"></textarea>

    <!-- Preview
    <h4 data-i18n="options.modal.import.preview">Preview</h4>
    <pre id="importPreview" class="preview-box"></pre> -->

    <p class="mt-12" data-i18n="options.import.note">
      Only selected groups will be applied. Merge preserves existing items and updates by ID.
    </p>

    <menu>
      <button class="btn icon-left i-undo" id="cancelImportBtn" data-i18n="options.btn.cancel">Cancel</button>
      <button class="btn primary icon-left i-file" id="doImportBtn" data-i18n="options.btn.importSettings">Import settings</button>
    </menu>
  </form>
</dialog>

  <!-- Export Settings Modal -->
  <dialog id="exportModal">
    <form method="dialog">
      <h3 data-i18n="options.export.title">Export settings</h3>

      <fieldset class="mt-12 fieldset-column">
        <legend data-i18n="options.export.groups">Groups to export</legend>
        <label class="toggle toggle--inline">
          <span class="toggle__text" data-i18n="options.export.providers">Provider Settings</span>
          <span class="toggle__control">
            <input type="checkbox" name="exgrp" value="providers" class="toggle__input" checked>
            <span class="toggle__track" aria-hidden="true">
              <span class="toggle__thumb"></span>
            </span>
          </span>
        </label>
        <label class="toggle toggle--inline">
          <span class="toggle__text" data-i18n="options.export.providersKeys">Include API keys</span>
          <span class="toggle__control">
            <input type="checkbox" name="exprovkeys" id="exprovkeys" class="toggle__input">
            <span class="toggle__track" aria-hidden="true">
              <span class="toggle__thumb"></span>
            </span>
          </span>
        </label>
        <label class="toggle toggle--inline">
          <span class="toggle__text" data-i18n="options.export.models">Models</span>
          <span class="toggle__control">
            <input type="checkbox" name="exgrp" value="models" class="toggle__input" checked>
            <span class="toggle__track" aria-hidden="true">
              <span class="toggle__thumb"></span>
            </span>
          </span>
        </label>
        <label class="toggle toggle--inline">
          <span class="toggle__text" data-i18n="options.export.sites">Auto-extraction Rules</span>
          <span class="toggle__control">
            <input type="checkbox" name="exgrp" value="sites" class="toggle__input" checked>
            <span class="toggle__track" aria-hidden="true">
              <span class="toggle__thumb"></span>
            </span>
          </span>
        </label>
        <label class="toggle toggle--inline">
          <span class="toggle__text" data-i18n="options.export.cv">CV</span>
          <span class="toggle__control">
            <input type="checkbox" name="exgrp" value="cv" class="toggle__input" checked>
            <span class="toggle__track" aria-hidden="true">
              <span class="toggle__thumb"></span>
            </span>
          </span>
        </label>
        <label class="toggle toggle--inline">
          <span class="toggle__text" data-i18n="options.export.system">System Prompt Template</span>
          <span class="toggle__control">
            <input type="checkbox" name="exgrp" value="systemTemplate" class="toggle__input" checked>
            <span class="toggle__track" aria-hidden="true">
              <span class="toggle__thumb"></span>
            </span>
          </span>
        </label>
        <label class="toggle toggle--inline">
          <span class="toggle__text" data-i18n="options.export.output">Result Output Template</span>
          <span class="toggle__control">
            <input type="checkbox" name="exgrp" value="outputTemplate" class="toggle__input" checked>
            <span class="toggle__track" aria-hidden="true">
              <span class="toggle__thumb"></span>
            </span>
          </span>
        </label>
        <label class="toggle toggle--inline">
          <span class="toggle__text" data-i18n="options.export.integrations">Integrations (Notion)</span>
          <span class="toggle__control">
            <input type="checkbox" name="exgrp" value="integrations" class="toggle__input" checked>
            <span class="toggle__track" aria-hidden="true">
              <span class="toggle__thumb"></span>
            </span>
          </span>
        </label>
        <label class="toggle toggle--inline">
          <span class="toggle__text" data-i18n="options.export.integrationsSecret">Include Notion integration token</span>
          <span class="toggle__control">
            <input type="checkbox" name="exintsecret" id="exintsecret" class="toggle__input">
            <span class="toggle__track" aria-hidden="true">
              <span class="toggle__thumb"></span>
            </span>
          </span>
        </label>
      </fieldset>

      <menu>
        <button class="btn icon-left i-undo" id="cancelExportBtn" data-i18n="options.btn.cancel">Cancel</button>
        <button class="btn primary icon-left i-download" id="doExportBtn" data-i18n="options.export.start">Export Selected</button>
      </menu>
    </form>
  </dialog>

  <!-- Reset to Defaults Modal -->
  <dialog id="resetDefaultsModal">
    <form method="dialog">
      <h3 data-i18n="options.modal.reset.title">Reset settings</h3>
      <p data-i18n="options.modal.reset.desc">This will replace providers, models, site rules, and templates with default values.</p>

      <label class="toggle toggle--inline">
        <span class="toggle__text" data-i18n="options.modal.reset.keepKeys">Keep API keys</span>
        <span class="toggle__control">
          <input type="checkbox" id="keepApiKeys" class="toggle__input" checked>
          <span class="toggle__track" aria-hidden="true">
            <span class="toggle__thumb"></span>
          </span>
        </span>
      </label>

      <menu>
        <button class="btn icon-left i-undo" id="cancelResetDefaultsBtn" value="cancel" data-i18n="options.btn.cancel">Cancel</button>
        <button class="btn danger icon-left i-eraser" id="doResetDefaultsBtn" value="default" data-i18n="options.modal.reset.apply">Reset</button>
      </menu>
    </form>
  </dialog>

    
    <script type="module" src="./js/options-main.js"></script>
</body>
</html>
