# План перехода основного overlay на Neumorphism

## Цель
Переработать плавающее окно (`#jda-app-overlay`) и встроенный интерфейс (`ui/popup.html`) в стилистику Neumorphism: мягкие объёмы, градиентные поверхности, диффузные тени и чёткая иерархия элементов при сохранении читабельности и взаимодействий (drag, resize, кнопки, доступность).

## Исходное состояние
- Обёртка создаётся и стилизуется внутри `content/app-overlay.js` через встроенный `<style>`; цвета тёмные (navy/gray), тени жёсткие.
- В iframe живёт основной UI (`ui/css/popup.css`, React/Vue отсутствует) с более "панельным" дизайном.
- Существуют интерактивы: перетаскивание, кнопки (meta/menu/close), resize-хэндл, iframe с формами/табами.

## Работы по Neumorphism
1. **Дизайн-токены и палитра**
   - Определить светлую базовую поверхность (например, `#e6ecf4`) и тёмную (`#121826`) для возможного dark-mode.
   - Ввести CSS-переменные в `content/app-overlay.js` и `ui/css/popup.css` (`--surface`, `--shadow-light`, `--shadow-dark`, `--accent`).
   - Зафиксировать источник света (обычно сверху-слева) и набор box-shadow (наружный + внутренний) для нормального/нажатого состояния.

2. **Обновление контейнера и карты overlay (content/app-overlay.js)**
   - Перенастроить `#jda-app-overlay` и `.jda-app-overlay-card` на новые цвета, закругления (`border-radius: 28px`), крупные мягкие тени (`15px 15px 35px rgba(...)` и `-15px -15px 35px rgba(...,0.7)`).
   - Добавить псевдо-элемент для эффекта "выпуклой" кромки и плавных переходов при drag.
   - Рассмотреть перенос CSS из JS в отдельный файл (например, `content/app-overlay.css`) и инжектить `chrome.runtime.getURL`, чтобы упростить поддержку.

3. **Шапка и кнопки действий**
   - Верстка: оставить flex, но добавить фон того же цвета с внутренней тенью, уменьшить gap для Neumorphism.
   - Кнопки (`#metaOverlay`, `#menu`, `button[data-action="close"]`): сделать круглые/овальные капсулы с двойными тенями (наружная для норм, внутренняя для active). Добавить фокус-рамку (`outline: 2px solid var(--accent)`).
   - Иконки: заменить символы `M`, `☰`, `✕` на SVG-иконки с монотонными заливками; хранить в `icons/` и подгружать как data-uri/background-image.

4. **Корпус и iframe**
   - `jda-app-overlay-body`: добавить внутреннюю тень (`box-shadow: inset 8px 8px 16px ...`) и скруглённые углы, чтобы iframe выглядел как впадина.
   - Создать фон-градиент (linear-gradient) для плавного перехода от верхнего света к нижней тени.
   - Добавить мягкий padding вокруг iframe, либо вложенную рамку для отделения содержимого.

5. **Resize-хэндл**
   - Изменить прямоугольную плашку на круглый или "таб" элемент с двойной тенью и светлой линией в центре.
   - Обновить курсор и hover/active состояния (внутренняя тень при зажатии).

6. **Взаимодействия (drag, hover, active)**
   - Во время перетаскивания добавлять класс `jda-overlay-dragging`: снижать тени и немного уменьшать непрозрачность, чтобы создать эффект приподнятости.
   - Для кнопок и интерактивных поверхностей прописать `transition: box-shadow 200ms, transform 150ms`.
   - Следить за доступностью: контраст текста >= 4.5:1; при необходимости добавлять отдельные тёмные/светлые темы.

7. **Внутренний UI (iframe)**
   - Пройтись по ключевым блокам в `ui/css/popup.css`: навигация вкладок, формы, блоки результатов, кнопки действий, textarea.
   - Каждую панель обернуть в контейнеры со светлой поверхностью, добавить отбрасываемые/вдавленные тени в зависимости от сценария (кнопки — выпуклые, поля ввода — вдавленные).
   - Для toggle/checkbox переключателей добавить псевдо-элементы в стиле Neumorphism (капсулы с подсветкой).
   - Проверить совместимость с мета-overlay внутри iframe (если отображается) или синхронизировать палитру.

8. **Поддержка адаптивности и prefers-color-scheme**
   - Добавить ветки CSS для тонкой настройки на узких экранах (`max-width: 520px`), сохранив Neumorphic эффекты.
   - Рассмотреть dark-mode: инвертировать тени (светлая подсветка + более тёмная поверхность).

9. **Тестирование и регрессии**
   - Прогнать ручные сценарии: drag, resize, meta overlay кнопка, открытие опций, копирование текста.
   - Проверить производительность (тени могут быть тяжёлыми) и убедиться, что Content-Security-Policy не нарушен (никаких inline style attrs, только инжектируемый `<style>`).

10. **Документация**
    - Обновить `README.md` / `README.ru.md` (раздел UI) и changelog.
    - Зафиксировать скриншоты before/after в `docs/images/`. 
    - Добавить краткий гайд по токенам (например, `docs/ui/overlay-theme.md`).

## Выходные артефакты
- Обновлённый `content/app-overlay.js` (или новый CSS файл) и `ui/css/popup.css`.
- Новые SVG иконки в `icons/`.
- Документация/скриншоты в `docs/`.
- Тестовый чек-лист для QA (можно в `docs/ui/overlay-neumorphism-checklist.md`).
